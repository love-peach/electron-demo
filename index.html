<!DOCTYPE html>
<html style="height:100%">
<head>
    <meta charset="UTF-8">
    <title>小鸭哥商户平台</title>
</head>
<body style="height:100%;overflow: hidden;margin: 0;">
<div style="position: absolute;top: 60px;right: 0">
    <h1>Hello World!</h1>
    <!-- All of the Node.js APIs are available in this renderer process. -->
    We are using node <script>document.write(process.versions.node)</script>,
    Chromium <script>document.write(process.versions.chrome)</script>,
    and Electron <script>document.write(process.versions.electron)</script>.
    <div class="indicator"></div>
</div>

<!--<webview id="foo" layout_weight="1" src="http://www.adobe.com/software/flash/about/" style="display: block;height: 100%;" plugins></webview>-->
<webview id="foo" layout_weight="1" src="http://mp.test.xiaoyage.com" style="display: block;height: 100%;" plugins></webview>


<script>
  onload = function() {
    var webview = document.getElementById("foo");
    var indicator = document.querySelector(".indicator");

    var loadstart = function() {
      indicator.innerText = "loading...";
    }
    var loadstop = function() {
      indicator.innerText = "";
    }
    webview.addEventListener("did-start-loading", loadstart);
    webview.addEventListener("did-stop-loading", loadstop);
  }
</script>
<script src='http://localhost:8000/CLodopfuncs.js'></script>
<script>

        function demoPrint(toPrview){
                var strHTML=document.getElementsByTagName("html")[0].innerHTML;
                LODOP.PRINT_INITA(10,20,810,610,"测试C-Lodop远程打印四步骤");
                LODOP.SET_PRINTER_INDEXA(document.getElementById("Select01").value);
                LODOP.SET_PRINT_PAGESIZE(0,0,0,document.getElementById("Select02").value);
                LODOP.ADD_PRINT_TEXT(1,1,300,200,"下面输出的是本页源代码及其展现效果：");
                LODOP.ADD_PRINT_TEXT(20,10,"90%","95%",strHTML);
                LODOP.SET_PRINT_STYLEA(0,"ItemType",4);
                LODOP.NewPageA();
                LODOP.ADD_PRINT_HTM(20,10,"90%","95%",strHTML);
                if (toPrview)
                    LODOP.PREVIEW();
                else
                    LODOP.PRINT();
        };
        function demoCreatePrinterList(){
                CLODOP.Create_Printer_List(document.getElementById('Select01'));
                demoCreatePagSizeList();
        };
	function demoCreatePagSizeList(){
                 var oSelect=document.getElementById('Select02');
                 var iPrintIndex=document.getElementById("Select01").value;
                 CLODOP.Create_PageSize_List(oSelect,iPrintIndex);
	};
        function demoCreateCLodopJSscript(strSrc){
                         var ScriptSS=document.getElementsByTagName("script");
                         for(var i in ScriptSS){
                                   if (ScriptSS[i].src && (ScriptSS[i].src.indexOf("CLodopfuncs.js")>=0)) {
                                        if (ScriptSS[i].parentNode) ScriptSS[i].parentNode.removeChild( ScriptSS[i] );
                                   };
                         };
                         var oscript=document.createElement("script");
                         if (strSrc.indexOf("=")>=0) {strSrc=strSrc.match(/=[\',\"][^\',^\"].*(?=[\',\"])/i);strSrc=strSrc[0].slice(2);}
                         oscript.src=strSrc;
                         var head = document.head || document.getElementsByTagName("head")[0] || document.documentElement;
                         head.insertBefore(oscript,head.firstChild);
                         return oscript;
        };
        function demoSetClodopJS(strSrc){
                 var oscript=demoCreateCLodopJSscript(strSrc);
                 oscript.onload =oscript.onreadystatechange= function() {
                         if ((!oscript.readyState|| /loaded|complete/.test(oscript.readyState)))
                         demoCreatePrinterList();
                 };
        };

</script>
<span style="font-size:14px">
&nbsp;一、C-Lodop是云打印服务，可接受JS语句实现远端输出，它是因满足平板电脑和手机浏览器打印而诞生的，由于其轻巧便捷，<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;所以也可以安装在PC本地，是打印控件Lodop的升级产品。其在保持打印性能的同时，能适应所有浏览器的各种版本。<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;引用C-Lodop很简单，在页面head中<a href="javascript:;" onclick="javascript:demoSetClodopJS(document.getElementById('T12B').value);">添加</a>
如下路径的js文件，就可以向本服务发打印请求了：<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="T1" id="T12B" size="100" value="<script src='http://localhost:8000/CLodopfuncs.js'></script>"><br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 如果C-Lodop服务安装在PC本地，页面则用localhost或127.0.0.1向其发送打印请求：<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="T2" size="100" value="<script src='http://localhost:8000/CLodopfuncs.js'></script>"> <br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;页面引用以上js之后，就可以调用Lodop传统功能，
点<a href="javascript:;" onclick="javascript:eval(document.getElementById('text01').value);">打印预览</a>执行如下经典语句(注意区分大小写)看看效果：<br><br>

<textarea rows="7" id="text01" cols="100">  var strHTML=document.getElementsByTagName("html")[0].innerHTML;
  LODOP.PRINT_INITA(1,1,770,660,"测试预览功能");
  LODOP.ADD_PRINT_TEXT(10,60,300,200,"这是测试的纯文本，下面是超文本:");
  LODOP.ADD_PRINT_HTM(30,5,"100%","80%",strHTML);
  LODOP.PREVIEW();
</textarea><br><br>

&nbsp;&nbsp;&nbsp;&nbsp;下面是远程打印的常见四步骤：<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;第一步选择云主机:<select id="Select00" size="1" onchange="demoSetClodopJS(document.getElementById('Select00').value)">
  <option value="http://localhost:8000/CLodopfuncs.js">本机方式1：http://localhost:8000/CLodopfuncs.js</option>
  <option value="http://127.0.0.1:8000/CLodopfuncs.js">本机方式2：http://127.0.0.1:8000/CLodopfuncs.js</option>
  <option value="http://localhost:8000/CLodopfuncs.js">按IP地址：http://localhost:8000/CLodopfuncs.js</option>
</select><br><br>
&nbsp;&nbsp;&nbsp;&nbsp;第二步选择打印机:<select id="Select01" size="1" onchange="demoCreatePagSizeList()"><option value="0">ZDesigner 105SL 203DPI</option><option value="1">Microsoft XPS Document Writer</option><option value="2">Fax</option></select><br><br>
&nbsp;&nbsp;&nbsp;&nbsp;第三步选纸张类型:<select id="Select02" size="1"><option value="信纸">信纸</option><option value="小号信纸">小号信纸</option><option value="Tabloid">Tabloid</option><option value="Ledger">Ledger</option><option value="法律专用纸">法律专用纸</option><option value="Statement">Statement</option><option value="Executive">Executive</option><option value="A3">A3</option><option value="A4">A4</option><option value="A4 小号">A4 小号</option><option value="A5">A5</option><option value="B4 (JIS)">B4 (JIS)</option><option value="B5 (JIS)">B5 (JIS)</option><option value="Folio">Folio</option><option value="Quarto">Quarto</option><option value="10x14">10x14</option><option value="11x17">11x17</option><option value="便笺">便笺</option><option value="信封 #9">信封 #9</option><option value="信封 #10">信封 #10</option><option value="信封 #11">信封 #11</option><option value="信封 #12">信封 #12</option><option value="信封 #14">信封 #14</option><option value="C size sheet">C size sheet</option><option value="D size sheet">D size sheet</option><option value="E size sheet">E size sheet</option><option value="信封 DL">信封 DL</option><option value="信封 C5">信封 C5</option><option value="信封 C3">信封 C3</option><option value="信封 C4">信封 C4</option><option value="信封 C6">信封 C6</option><option value="信封 C65">信封 C65</option><option value="信封 B4">信封 B4</option><option value="信封 B5">信封 B5</option><option value="信封 B6">信封 B6</option><option value="信封">信封</option><option value="信封 Monarch">信封 Monarch</option><option value="6 3/4 信封">6 3/4 信封</option><option value="美国标准 Fanfold">美国标准 Fanfold</option><option value="德国标准 Fanfold">德国标准 Fanfold</option><option value="德国法律专用纸 Fanfold">德国法律专用纸 Fanfold</option><option value="B4 (ISO)">B4 (ISO)</option><option value="日式明信片">日式明信片</option><option value="9x11">9x11</option><option value="10x11">10x11</option><option value="15x11">15x11</option><option value="信封邀请函">信封邀请函</option><option value="特大信纸">特大信纸</option><option value="特大法律专用纸">特大法律专用纸</option><option value="A4 特大">A4 特大</option><option value="信纸横向">信纸横向</option><option value="A4 横向">A4 横向</option><option value="特大信纸横向">特大信纸横向</option><option value="Super A">Super A</option><option value="Super B">Super B</option><option value="信纸加大">信纸加大</option><option value="A4 加大">A4 加大</option><option value="A5 横向">A5 横向</option><option value="B5 (JIS) 横向">B5 (JIS) 横向</option><option value="A3 特大">A3 特大</option><option value="A5 特大">A5 特大</option><option value="B5 (ISO) 特大">B5 (ISO) 特大</option><option value="A2">A2</option><option value="A3 横向">A3 横向</option><option value="A3 特大横向">A3 特大横向</option><option value="日式往返明信片">日式往返明信片</option><option value="A6">A6</option><option value="日式信封 Kaku #2">日式信封 Kaku #2</option><option value="日式信封 Kaku #3">日式信封 Kaku #3</option><option value="日式信封 Chou #3">日式信封 Chou #3</option><option value="日式信封 Chou #4">日式信封 Chou #4</option><option value="信纸旋转">信纸旋转</option><option value="A3 旋转">A3 旋转</option><option value="A4 旋转">A4 旋转</option><option value="A5 旋转">A5 旋转</option><option value="B4 (JIS) 旋转">B4 (JIS) 旋转</option><option value="B5 (JIS) 旋转">B5 (JIS) 旋转</option><option value="日式明信片旋转">日式明信片旋转</option><option value="双层日式明信片旋转">双层日式明信片旋转</option><option value="A6 旋转">A6 旋转</option><option value="日式信封 Kaku #2 旋转">日式信封 Kaku #2 旋转</option><option value="日式信封 Kaku #3 旋转">日式信封 Kaku #3 旋转</option><option value="日式信封 Chou #3 旋转">日式信封 Chou #3 旋转</option><option value="日式信封 Chou #4 旋转">日式信封 Chou #4 旋转</option><option value="B6 (JIS)">B6 (JIS)</option><option value="B6 (JIS) 旋转">B6 (JIS) 旋转</option><option value="12x11">12x11</option><option value="日式信封 You #4">日式信封 You #4</option><option value="日式信封 You #4 旋转">日式信封 You #4 旋转</option><option value="PRC 信封 #1">PRC 信封 #1</option><option value="PRC 信封 #3">PRC 信封 #3</option><option value="PRC 信封 #4">PRC 信封 #4</option><option value="PRC 信封 #5">PRC 信封 #5</option><option value="PRC 信封 #6">PRC 信封 #6</option><option value="PRC 信封 #7">PRC 信封 #7</option><option value="PRC 信封 #8">PRC 信封 #8</option><option value="PRC 信封 #9">PRC 信封 #9</option><option value="PRC 信封 #10">PRC 信封 #10</option><option value="PRC 信封 #1 旋转">PRC 信封 #1 旋转</option><option value="PRC 信封 #3 旋转">PRC 信封 #3 旋转</option><option value="PRC 信封 #4 旋转">PRC 信封 #4 旋转</option><option value="PRC 信封 #5 旋转">PRC 信封 #5 旋转</option><option value="PRC 信封 #6 旋转">PRC 信封 #6 旋转</option><option value="PRC 信封 #7 旋转">PRC 信封 #7 旋转</option><option value="PRC 信封 #8 旋转">PRC 信封 #8 旋转</option><option value="PRC 信封 #9 旋转">PRC 信封 #9 旋转</option></select><br><br>
&nbsp;&nbsp;&nbsp;&nbsp;最后是<a href="javascript:demoPrint(true);">打印预览</a>，或者不预览而<a href="javascript:demoPrint();">直接打印</a><br><br>

&nbsp;二、默认情况下，只要能访问本页，都可以通过本服务控制打印机输出，为了阻止陌生请求，<br><br>
&nbsp;&nbsp;&nbsp;&nbsp; 管理者可以从这里为guest用户<a href="/c_mpermit">设置一个密码</a>（设置前需用admin身份登录，初始密码皆空）。<br><br>
&nbsp;三、本服务的http端口是8000，端口冲突时会自动变大。<br><br>
&nbsp;四、这是一个免费打印服务软件，您可以长期使用，但不能用来<a href="/c_mlicense" target="_blank">商用</a>谋利。<br><br>
&nbsp;五、如果出现故障，可以点这里<a href="/c_sysmessage" target="_blank">查看系统信息</a>。<br><br>
&nbsp;六、最后欣赏用其实现&nbsp;<a href="/CLodopDemos/PrintSampIndex.html" target="_blank">Lodop全部传统例子&gt;&gt;</a><br><br><br><br>
</span>
</body>
</html>